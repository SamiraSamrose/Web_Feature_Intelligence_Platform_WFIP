<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Feature Intelligence Platform</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
        }

        .header h1 {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-tab {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            padding: 15px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #667eea;
        }

        .nav-tab:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 20px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.15);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .card h3 {
            color: #764ba2;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .stat-card .value {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-card .detail {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .feature-list {
            list-style: none;
        }

        .feature-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .feature-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .feature-name {
            font-weight: 600;
            color: #333;
        }

        .badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge.high-risk {
            background: #ff4757;
            color: white;
        }

        .badge.medium-risk {
            background: #ffa502;
            color: white;
        }

        .badge.low-risk {
            background: #2ed573;
            color: white;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .input-group input, .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: border 0.3s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 20px;
        }

        .heatmap-cell {
            aspect-ratio: 1;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            text-align: center;
            padding: 10px;
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .heatmap-cell:hover {
            transform: scale(1.05);
        }

        .heatmap-cell .team-name {
            font-size: 0.85em;
            margin-bottom: 5px;
        }

        .heatmap-cell .percentage {
            font-size: 1.8em;
        }

        .risk-report {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            display: none;
        }

        .risk-report.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .risk-score {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .risk-gauge {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: 700;
            color: white;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }

        .timeline {
            position: relative;
            padding-left: 30px;
            margin-top: 20px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #667eea;
        }

        .timeline-item {
            margin-bottom: 20px;
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -35px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        .region-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .region-table th,
        .region-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .region-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #667eea;
        }

        .region-table tr:hover {
            background: #f8f9fa;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .alert-banner {
            background: #fff3cd;
            border-left: 4px solid #ffa502;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            color: #856404;
        }

        .alert-banner strong {
            color: #664d03;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .ml-insight-box {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
            border-left: 4px solid #667eea;
        }

        .ml-insight-box h4 {
            color: #667eea;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .rum-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .rum-stat {
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .rum-stat .label {
            font-size: 0.85em;
            color: #666;
            margin-bottom: 5px;
        }

        .rum-stat .value {
            font-size: 1.5em;
            font-weight: 700;
            color: #667eea;
        }

        .code-snippet {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            margin-top: 15px;
        }

        .code-snippet .keyword {
            color: #ff79c6;
        }

        .code-snippet .string {
            color: #f1fa8c;
        }

        .code-snippet .comment {
            color: #6272a4;
        }

        .ab-test-card {
            background: #f0f7ff;
            border: 2px solid #667eea;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .ab-test-card h4 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .cohort-split {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .cohort {
            flex: 1;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .cohort h5 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .test-data-notice {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 0.9em;
        }

        .test-data-notice strong {
            color: #1976D2;
        }

        .detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .detail-modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #ff4757;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Web Feature Intelligence Platform</h1>
            <p>Smart dashboard for tracking web feature compatibility, technical debt, and risk-aware decision making</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="switchTab('compatibility')">Compatibility Scoring</button>
            <button class="nav-tab" onclick="switchTab('heatmap')">Internal UI Heatmap</button>
            <button class="nav-tab" onclick="switchTab('risk')">Feature Risk Scorer</button>
            <button class="nav-tab" onclick="switchTab('ml')">ML Insights</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="alert-banner">
                <strong>üîî New Alert:</strong> CSS :has() usage detected in 3 production UIs. Estimated 2.8M users may experience degraded layouts. <a href="#" onclick="switchTab('risk'); return false;" style="color: #667eea; font-weight: 600;">Review Risk Report ‚Üí</a>
            </div>

            <div class="grid">
                <div class="stat-card" onclick="showStatDetail('global-support')">
                    <h3>Global Support Score</h3>
                    <div class="value">87.3%</div>
                    <div class="detail">Across all deployed UIs</div>
                </div>
                <div class="stat-card" onclick="showStatDetail('critical-issues')">
                    <h3>Critical Issues</h3>
                    <div class="value">12</div>
                    <div class="detail">High-risk features in production</div>
                </div>
                <div class="stat-card" onclick="showStatDetail('apps-scanned')">
                    <h3>Apps Scanned</h3>
                    <div class="value">47</div>
                    <div class="detail">Internal & external UIs</div>
                </div>
                <div class="stat-card" onclick="showStatDetail('users-impacted')">
                    <h3>Users Impacted</h3>
                    <div class="value">2.4M</div>
                    <div class="detail">Potentially degraded experience</div>
                </div>
            </div>

            <div class="card">
                <h2>Recent Feature Alerts</h2>
                <ul class="feature-list">
                    <li class="feature-item" onclick="showFeatureDetail('has-selector')">
                        <span class="feature-name">CSS :has() selector - Dashboard v2.3</span>
                        <span class="badge high-risk">High Risk - 32% users</span>
                    </li>
                    <li class="feature-item" onclick="showFeatureDetail('container-queries')">
                        <span class="feature-name">Container Queries - Product Page</span>
                        <span class="badge high-risk">High Risk - 28% users</span>
                    </li>
                    <li class="feature-item" onclick="showFeatureDetail('backdrop-filter')">
                        <span class="feature-name">backdrop-filter - Modal Component</span>
                        <span class="badge medium-risk">Medium Risk - 15% users</span>
                    </li>
                    <li class="feature-item" onclick="showFeatureDetail('scroll-snap')">
                        <span class="feature-name">scroll-snap - Gallery View</span>
                        <span class="badge low-risk">Low Risk - 5% users</span>
                    </li>
                </ul>
            </div>

            <div class="card">
                <h2>Feature Usage Trends</h2>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>

            <div class="card">
                <h2>ü§ñ ML-Powered Predictions</h2>
                <div class="ml-insight-box">
                    <h4>‚ö†Ô∏è Risk Prediction Alert</h4>
                    <p><strong>Model Prediction:</strong> UIs with 3+ high-risk features have a 40% higher error rate based on historical data. Dashboard v2.3 currently has 4 high-risk features.</p>
                    <p style="margin-top: 10px;"><strong>Recommendation:</strong> Reduce to ‚â§2 high-risk features before next release or implement comprehensive fallbacks.</p>
                </div>
            </div>
        </div>

        <!-- Compatibility Scoring Tab -->
        <div id="compatibility" class="tab-content">
            <div class="card">
                <h2>üåç Global Compatibility Analysis</h2>
                
                <div class="test-data-notice">
                    <strong>üìä Test Data Notice:</strong> This demo uses simulated compatibility data. In production, data is sourced from: 
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>MDN Browser Compat Data API for feature support matrices</li>
                        <li>StatCounter Global Stats for real-time browser market share by region</li>
                        <li>Your company's analytics (Google Analytics, Mixpanel) for actual user demographics</li>
                        <li>Static analysis of your codebase using Babel/PostCSS to detect feature usage</li>
                    </ul>
                </div>

                <div class="input-group">
                    <label>Select UI/Component</label>
                    <select id="uiSelect">
                        <option value="dashboard">Dashboard v2.3 (CSS :has(), Container Queries)</option>
                        <option value="product">Product Listing Page (Grid, Flexbox)</option>
                        <option value="profile">User Profile (backdrop-filter, scroll-snap)</option>
                        <option value="admin">Admin Panel (MutationObserver, legacy patterns)</option>
                    </select>
                </div>
                <button class="btn" id="analyzeBtn" onclick="analyzeCompatibility()">
                    <span id="analyzeBtnText">Analyze Compatibility</span>
                </button>

                <div id="compatResult" style="display: none; margin-top: 20px;">
                    <h3>Compatibility Report: <span id="selectedUI"></span></h3>
                    <div class="grid">
                        <div class="stat-card">
                            <h3>Global Support</h3>
                            <div class="value" id="globalSupport">76.8%</div>
                        </div>
                        <div class="stat-card">
                            <h3>Baseline Compliant</h3>
                            <div class="value" id="baselineCompliant">64%</div>
                        </div>
                        <div class="stat-card">
                            <h3>Features Detected</h3>
                            <div class="value" id="featuresDetected">8</div>
                        </div>
                        <div class="stat-card">
                            <h3>Risk Score</h3>
                            <div class="value" id="riskScore">6.2/10</div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <canvas id="compatChart"></canvas>
                    </div>

                    <table class="region-table">
                        <thead>
                            <tr>
                                <th>Region</th>
                                <th>Support %</th>
                                <th>Browser Distribution</th>
                                <th>Impact</th>
                            </tr>
                        </thead>
                        <tbody id="regionTableBody">
                        </tbody>
                    </table>

                    <h3 style="margin-top: 30px;">Top Affected Markets</h3>
                    <ul class="feature-list" id="affectedMarketsList">
                    </ul>

                    <div class="ml-insight-box">
                        <h4>ü§ñ ML Insight</h4>
                        <p><strong>Predictive Analysis:</strong> Based on similar UIs deployed in the past 6 months, this feature set has a <strong>68% probability</strong> of causing increased error rates in India and Brazil markets.</p>
                        <p style="margin-top: 10px;"><strong>Historical Data:</strong> 12 UIs with similar risk profiles showed 2.3x higher support tickets in first week post-launch.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Heatmap Tab -->
        <div id="heatmap" class="tab-content">
            <div class="card">
                <h2>üó∫Ô∏è Internal UI Technical Debt Heatmap</h2>
                
                <div class="test-data-notice">
                    <strong>üìä Test Data Notice:</strong> In production, this data comes from:
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>Puppeteer/Playwright crawlers scanning internal URLs every night</li>
                        <li>DevTools Protocol extracting computed CSS and JS feature usage</li>
                        <li>Git repository analysis tracking feature adoption over time</li>
                        <li>Comparison against MDN Baseline allowlist to flag non-compliant patterns</li>
                    </ul>
                </div>

                <p style="margin-bottom: 20px;">Baseline feature compliance across teams (higher = better). Click any team for detailed breakdown.</p>
                
                <div class="heatmap-grid">
                    <div class="heatmap-cell" style="background: #2ed573;" onclick="showTeamDetail('alpha', 92)">
                        <div class="team-name">Team Alpha</div>
                        <div class="percentage">92%</div>
                    </div>
                    <div class="heatmap-cell" style="background: #26de81;" onclick="showTeamDetail('bravo', 85)">
                        <div class="team-name">Team Bravo</div>
                        <div class="percentage">85%</div>
                    </div>
                    <div class="heatmap-cell" style="background: #ffa502;" onclick="showTeamDetail('charlie', 68)">
                        <div class="team-name">Team Charlie</div>
                        <div class="percentage">68%</div>
                    </div>
                    <div class="heatmap-cell" style="background: #ff6348;" onclick="showTeamDetail('delta', 57)">
                        <div class="team-name">Team Delta</div>
                        <div class="percentage">57%</div>
                    </div>
                    <div class="heatmap-cell" style="background: #ff4757;" onclick="showTeamDetail('echo', 43)">
                        <div class="team-name">Team Echo</div>
                        <div class="percentage">43%</div>
                    </div>
                    <div class="heatmap-cell" style="background: #45e897;" onclick="showTeamDetail('foxtrot', 78)">
                        <div class="team-name">Team Foxtrot</div>
                        <div class="percentage">78%</div>
                    </div>
                    <div class="heatmap-cell" style="background: #2ed573;" onclick="showTeamDetail('golf', 91)">
                        <div class="team-name">Team Golf</div>
                        <div class="percentage">91%</div>
                    </div>
                    <div class="heatmap-cell" style="background: #ffa502;" onclick="showTeamDetail('hotel', 64)">
                        <div class="team-name">Team Hotel</div>
                        <div class="percentage">64%</div>
                    </div>
                </div>

                <h3 style="margin-top: 30px;">Legacy Feature Usage (Click for automated remediation)</h3>
                <ul class="feature-list">
                    <li class="feature-item" onclick="showRemediation('mutation')">
                        <div>
                            <div class="feature-name">Deprecated MutationObserver patterns</div>
                            <div style="font-size: 0.9em; color: #666;">25 UIs still using legacy implementations</div>
                        </div>
                        <span class="badge high-risk">Critical</span>
                    </li>
                    <li class="feature-item" onclick="showRemediation('prefix')">
                        <div>
                            <div class="feature-name">Non-standard CSS vendor prefixes</div>
                            <div style="font-size: 0.9em; color: #666;">18 UIs with -webkit- only styles</div>
                        </div>
                        <span class="badge medium-risk">Warning</span>
                    </li>
                    <li class="feature-item" onclick="showRemediation('docwrite')">
                        <div>
                            <div class="feature-name">document.write() in production</div>
                            <div style="font-size: 0.9em; color: #666;">12 UIs using synchronous scripts</div>
                        </div>
                        <span class="badge high-risk">Critical</span>
                    </li>
                    <li class="feature-item" onclick="showRemediation('flash')">
                        <div>
                            <div class="feature-name">Flash fallback code</div>
                            <div style="font-size: 0.9em; color: #666;">5 UIs with dead code paths</div>
                        </div>
                        <span class="badge low-risk">Cleanup</span>
                    </li>
                </ul>

                <div id="remediationBox" style="display: none;" class="ml-insight-box">
                    <h4>üîß Automated Remediation Available</h4>
                    <p id="remediationText"></p>
                    <button class="btn" style="margin-top: 15px;" onclick="generatePR()">Generate Pull Request</button>
                </div>
            </div>

            <div class="card">
                <h2>Team Breakdown - <span id="teamName">Team Echo</span> (<span id="teamScore">43</span>% Compliant)</h2>
                <div class="chart-container">
                    <canvas id="teamChart"></canvas>
                </div>

                <div class="rum-stats">
                    <div class="rum-stat">
                        <div class="label">Browser Crashes</div>
                        <div class="value">23</div>
                    </div>
                </div>

                <div class="test-data-notice" style="margin-top: 20px;">
                    <strong>üîó RUM Integration:</strong> Connected to Sentry for real-time error tracking. Errors are correlated with non-Baseline feature usage patterns.
                </div>
            </div>
        </div>

        <!-- Risk Scorer Tab -->
        <div id="risk" class="tab-content">
            <div class="card">
                <h2>üìä Feature Risk Assessment Tool</h2>
                
                <div class="test-data-notice">
                    <strong>üìä Test Data Notice:</strong> Risk calculations combine:
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>Can I Use API current browser support percentages</li>
                        <li>Your company's user demographics (browser/OS/region distribution)</li>
                        <li>Historical browser update velocity to project safe adoption timelines</li>
                        <li>ML model trained on 500+ past deployments correlating features with error rates</li>
                    </ul>
                </div>

                <p>Evaluate the risk and impact of adopting new web features</p>

                <div class="input-group">
                    <label>Feature Name</label>
                    <input type="text" id="featureName" placeholder="e.g., CSS :has() selector, Container Queries, View Transitions API">
                </div>

                <div class="input-group">
                    <label>Target Markets (optional)</label>
                    <select id="targetMarket">
                        <option>Global</option>
                        <option>North America</option>
                        <option>Europe</option>
                        <option>Asia Pacific</option>
                        <option>Latin America</option>
                        <option>India</option>
                    </select>
                </div>

                <button class="btn" onclick="assessRisk()">
                    <span id="assessBtnText">Assess Risk</span>
                </button>

                <div id="riskReport" class="risk-report">
                    <div class="risk-score">
                        <div class="risk-gauge" id="riskGauge" style="background: linear-gradient(135deg, #ff6348 0%, #ff4757 100%);">
                            7.5/10
                        </div>
                        <div>
                            <h3 id="riskLevel">High Risk Feature</h3>
                            <p id="riskDescription">CSS :has() selector will impact 32% of your global user base</p>
                        </div>
                    </div>

                    <div class="grid">
                        <div class="stat-card" style="background: linear-gradient(135deg, #ff6348 0%, #ff4757 100%);">
                            <h3>Global Support</h3>
                            <div class="value" id="supportPercentage">68%</div>
                            <div class="detail">Browser coverage</div>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #ffa502 0%, #ff6348 100%);">
                            <h3>Users Impacted</h3>
                            <div class="value" id="usersImpacted">8.2M</div>
                            <div class="detail">Potential degradation</div>
                        </div>
                        <div class="stat-card" style="background: linear-gradient(135deg, #45e897 0%, #2ed573 100%);">
                            <h3>Safe Adoption</h3>
                            <div class="value" id="safeYear">2026</div>
                            <div class="detail">Expected timeline</div>
                        </div>
                    </div>

                    <div class="chart-container">
                        <canvas id="riskTrendChart"></canvas>
                    </div>

                    <h3 style="margin-top: 30px;">Impact Timeline</h3>
                    <div class="timeline" id="impactTimeline">
                    </div>

                    <div class="ml-insight-box">
                        <h4>ü§ñ ML Risk Prediction</h4>
                        <p><strong>Model Confidence:</strong> 87%</p>
                        <p style="margin-top: 10px;"><strong>Analysis:</strong> Based on 127 similar features deployed in past 18 months, features with this support profile (68% global) showed:</p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>2.4x increase in JavaScript errors in first 2 weeks</li>
                            <li>18% increase in support tickets related to UI rendering</li>
                            <li>Average time-to-fix: 8.5 days</li>
                        </ul>
                    </div>

                    <div class="ab-test-card">
                        <h4>üß™ Recommended A/B Test Strategy</h4>
                        <p>Gradually roll out this feature to minimize risk:</p>
                        <div class="cohort-split">
                            <div class="cohort">
                                <h5>Control Group (60%)</h5>
                                <p><strong>Target:</strong> All users with older browsers</p>
                                <p><strong>Experience:</strong> Fallback implementation using JavaScript classList manipulation</p>
                                <p><strong>Browsers:</strong> Chrome <110, Safari <16.4, Firefox <121</p>
                            </div>
                            <div class="cohort">
                                <h5>Treatment Group (40%)</h5>
                                <p><strong>Target:</strong> Users with modern browsers</p>
                                <p><strong>Experience:</strong> Native :has() selector</p>
                                <p><strong>Browsers:</strong> Chrome 110+, Safari 16.4+, Firefox 121+</p>
                            </div>
                        </div>
                        <button class="btn" style="margin-top: 15px;" onclick="exportABConfig()">Export A/B Test Config</button>
                    </div>

                    <h3 style="margin-top: 30px;">üí° Safer Alternatives (Baseline-Aligned)</h3>
                    <ul class="feature-list" id="alternativesList">
                    </ul>

                    <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 10px; border-left: 4px solid #ffa502;">
                        <strong>‚ö†Ô∏è Recommendation:</strong> <span id="finalRecommendation">Delay adoption until Q4 2026 or implement with progressive enhancement. Consider the JavaScript alternative for critical UIs serving India and Latin America markets.</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ML Insights Tab -->
        <div id="ml" class="tab-content">
            <div class="card">
                <h2>ü§ñ Machine Learning Insights & Predictions</h2>
                
                <div class="test-data-notice">
                    <strong>üìä Model Training Data:</strong> ML models trained on:
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>500+ production deployments over 18 months</li>
                        <li>Error logs from Sentry/Datadog correlated with feature usage</li>
                        <li>Support ticket sentiment analysis</li>
                        <li>Browser telemetry and crash reports</li>
                    </ul>
                </div>

                <h3>Risk Prediction Model Performance</h3>
                <div class="grid">
                    <div class="stat-card" style="background: linear-gradient(135deg, #2ed573 0%, #26de81 100%);">
                        <h3>Model Accuracy</h3>
                        <div class="value">87.3%</div>
                        <div class="detail">On validation dataset</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <h3>Predictions Made</h3>
                        <div class="value">1,247</div>
                        <div class="detail">Last 90 days</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #ffa502 0%, #ff6348 100%);">
                        <h3>Prevented Issues</h3>
                        <div class="value">43</div>
                        <div class="detail">High-risk deployments blocked</div>
                    </div>
                </div>

                <div class="chart-container">
                    <canvas id="mlAccuracyChart"></canvas>
                </div>

                <h3 style="margin-top: 30px;">Feature Correlation Analysis</h3>
                <p style="margin-bottom: 15px;">Features most strongly correlated with production errors:</p>
                <ul class="feature-list">
                    <li class="feature-item">
                        <div>
                            <div class="feature-name">CSS :has() + Container Queries combination</div>
                            <div style="font-size: 0.9em; color: #666;">Correlation coefficient: 0.78 | Error rate: 4.2x baseline</div>
                        </div>
                        <span class="badge high-risk">High Correlation</span>
                    </li>
                    <li class="feature-item">
                        <div>
                            <div class="feature-name">backdrop-filter with animations</div>
                            <div style="font-size: 0.9em; color: #666;">Correlation coefficient: 0.64 | Error rate: 2.8x baseline</div>
                        </div>
                        <span class="badge medium-risk">Medium Correlation</span>
                    </li>
                    <li class="feature-item">
                        <div>
                            <div class="feature-name">View Transitions API</div>
                            <div style="font-size: 0.9em; color: #666;">Correlation coefficient: 0.52 | Error rate: 1.9x baseline</div>
                        </div>
                        <span class="badge medium-risk">Medium Correlation</span>
                    </li>
                </ul>

                <div class="ml-insight-box" style="margin-top: 30px;">
                    <h4>üéØ Predictive Recommendations</h4>
                    <p><strong>Next Quarter Forecast:</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>CSS Grid support will reach 95% in your user base (currently 92%)</li>
                        <li>Container Queries will reach safe adoption threshold (90%) by Q3 2026</li>
                        <li>:has() selector adoption should wait until Q4 2026 for your India market</li>
                    </ul>
                </div>

                <h3 style="margin-top: 30px;">Real User Monitoring (RUM) Integration</h3>
                <div class="rum-stats">
                    <div class="rum-stat">
                        <div class="label">Total Error Events (7d)</div>
                        <div class="value">12,847</div>
                    </div>
                    <div class="rum-stat">
                        <div class="label">Feature-Related Errors</div>
                        <div class="value">3,421</div>
                    </div>
                    <div class="rum-stat">
                        <div class="label">Avg Time to Detection</div>
                        <div class="value">4.2min</div>
                    </div>
                    <div class="rum-stat">
                        <div class="label">Cost of Errors</div>
                        <div class="value">$18.5K</div>
                    </div>
                </div>

                <div class="test-data-notice" style="margin-top: 20px;">
                    <strong>üîó Connected Services:</strong>
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li>‚úÖ Sentry: Real-time error tracking and source map integration</li>
                        <li>‚úÖ Datadog RUM: Performance metrics and user session replays</li>
                        <li>‚úÖ Google Analytics: User demographics and behavior flows</li>
                        <li>‚úÖ LogRocket: Session replay for debugging compatibility issues</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div id="detailModal" class="detail-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">√ó</button>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        let compatChart, teamChart, riskTrendChart, mlAccuracyChart;

        // Tab switching
        function switchTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        // Show stat detail modal
        function showStatDetail(statType) {
            const modalBody = document.getElementById('modalBody');
            const modal = document.getElementById('detailModal');
            
            const details = {
                'global-support': {
                    title: 'Global Support Score Breakdown',
                    content: `
                        <h2>87.3% Global Support</h2>
                        <p style="margin: 15px 0;">This score represents the weighted average of all 47 deployed UIs based on your actual user distribution.</p>
                        <h3>Calculation Method:</h3>
                        <div class="code-snippet">
<span class="keyword">function</span> calculateGlobalSupport(uis, userDistribution) {
    <span class="keyword">let</span> totalScore = 0;
    <span class="keyword">let</span> totalUsers = 0;
    
    uis.<span class="keyword">forEach</span>(ui => {
        <span class="keyword">const</span> support = getFeatureSupport(ui.features, userDistribution);
        totalScore += support * ui.monthlyUsers;
        totalUsers += ui.monthlyUsers;
    });
    
    <span class="keyword">return</span> (totalScore / totalUsers) * 100;
}
                        </div>
                        <h3 style="margin-top: 20px;">Top Contributing UIs:</h3>
                        <ul style="margin-left: 20px;">
                            <li>Product Listing (98% support, 8M users)</li>
                            <li>User Profile (94% support, 5.2M users)</li>
                            <li>Dashboard v2.3 (76% support, 3.1M users) ‚ö†Ô∏è</li>
                        </ul>
                    `
                },
                'critical-issues': {
                    title: 'Critical Issues Breakdown',
                    content: `
                        <h2>12 Critical Issues Detected</h2>
                        <p style="margin: 15px 0;">Features with <70% global support currently in production</p>
                        <ul class="feature-list" style="margin-top: 20px;">
                            <li class="feature-item">
                                <span>CSS :has() - 4 UIs</span>
                                <span class="badge high-risk">68% support</span>
                            </li>
                            <li class="feature-item">
                                <span>Container Queries - 3 UIs</span>
                                <span class="badge high-risk">72% support</span>
                            </li>
                            <li class="feature-item">
                                <span>View Transitions - 2 UIs</span>
                                <span class="badge high-risk">55% support</span>
                            </li>
                            <li class="feature-item">
                                <span>Popover API - 2 UIs</span>
                                <span class="badge high-risk">48% support</span>
                            </li>
                            <li class="feature-item">
                                <span>Scroll-driven Animations - 1 UI</span>
                                <span class="badge high-risk">34% support</span>
                            </li>
                        </ul>
                    `
                },
                'apps-scanned': {
                    title: 'Scanned Applications',
                    content: `
                        <h2>47 Applications Monitored</h2>
                        <h3>Internal Apps: 32</h3>
                        <ul style="margin: 10px 0 20px 20px;">
                            <li>Admin Dashboards (12)</li>
                            <li>Analytics Tools (8)</li>
                            <li>Internal Portals (7)</li>
                            <li>Dev Tools (5)</li>
                        </ul>
                        <h3>External/Customer-Facing: 15</h3>
                        <ul style="margin: 10px 0 20px 20px;">
                            <li>Main Product (3 variants)</li>
                            <li>Marketing Sites (4)</li>
                            <li>Support Portal (2)</li>
                            <li>Mobile Web Apps (6)</li>
                        </ul>
                        <div class="test-data-notice" style="margin-top: 20px;">
                            <strong>Scan Frequency:</strong> Nightly crawls at 2 AM UTC. Average scan time: 23 minutes.
                        </div>
                    `
                },
                'users-impacted': {
                    title: 'User Impact Analysis',
                    content: `
                        <h2>2.4M Users Potentially Impacted</h2>
                        <p style="margin: 15px 0;">Users who may experience degraded UX due to non-Baseline features</p>
                        <div class="rum-stats" style="margin-top: 20px;">
                            <div class="rum-stat">
                                <div class="label">Total Monthly Active Users</div>
                                <div class="value">18.7M</div>
                            </div>
                            <div class="rum-stat">
                                <div class="label">Affected Percentage</div>
                                <div class="value">12.8%</div>
                            </div>
                            <div class="rum-stat">
                                <div class="label">Critical (broken UX)</div>
                                <div class="value">890K</div>
                            </div>
                            <div class="rum-stat">
                                <div class="label">Minor (degraded UX)</div>
                                <div class="value">1.51M</div>
                            </div>
                        </div>
                        <h3 style="margin-top: 30px;">Geographic Distribution:</h3>
                        <ul style="margin-left: 20px;">
                            <li>India: 1.2M users (older Android devices)</li>
                            <li>Brazil: 580K users (Chrome 95-105)</li>
                            <li>Indonesia: 320K users (Opera Mini)</li>
                            <li>Other: 300K users</li>
                        </ul>
                    `
                }
            };

            const detail = details[statType];
            modalBody.innerHTML = `<h2>${detail.title}</h2>${detail.content}`;
            modal.classList.add('show');
        }

        // Show feature detail
        function showFeatureDetail(featureType) {
            const modalBody = document.getElementById('modalBody');
            const modal = document.getElementById('detailModal');
            
            const features = {
                'has-selector': {
                    title: 'CSS :has() Selector Analysis',
                    content: `
                        <h2>CSS :has() Selector - Dashboard v2.3</h2>
                        <div class="alert-banner">
                            <strong>‚ö†Ô∏è High Risk:</strong> 32% of users (8.2M) lack support
                        </div>
                        <h3 style="margin-top: 20px;">Usage Pattern Detected:</h3>
                        <div class="code-snippet">
<span class="comment">/* Found in dashboard.css line 234 */</span>
.card<span class="keyword">:has(</span>.active-badge<span class="keyword">)</span> {
    border: 2px solid #667eea;
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}
                        </div>
                        <h3 style="margin-top: 20px;">Browser Support:</h3>
                        <ul style="margin-left: 20px;">
                            <li>‚úÖ Chrome 105+ (68% of your users)</li>
                            <li>‚úÖ Safari 15.4+ (12% of your users)</li>
                            <li>‚úÖ Firefox 121+ (8% of your users)</li>
                            <li>‚ùå Samsung Internet <20 (7% of your users)</li>
                            <li>‚ùå Older Android browsers (5% of your users)</li>
                        </ul>
                        <h3 style="margin-top: 20px;">Recommended Fix:</h3>
                        <button class="btn" onclick="showRemediation('has'); closeModal();">Generate Automated Fix</button>
                    `
                },
                'container-queries': {
                    title: 'Container Queries Analysis',
                    content: `
                        <h2>Container Queries - Product Page</h2>
                        <div class="alert-banner">
                            <strong>‚ö†Ô∏è High Risk:</strong> 28% of users (7.1M) lack support
                        </div>
                        <h3 style="margin-top: 20px;">Current Support:</h3>
                        <p>72% global support | Baseline status: Newly Available (2023)</p>
                        <h3 style="margin-top: 20px;">Alternative Solution:</h3>
                        <p>Use ResizeObserver with vanilla JS or CSS Grid with media queries</p>
                    `
                },
                'backdrop-filter': {
                    title: 'backdrop-filter Analysis',
                    content: `
                        <h2>backdrop-filter - Modal Component</h2>
                        <div class="alert-banner" style="background: #fff3cd; border-color: #ffa502;">
                            <strong>‚ö†Ô∏è Medium Risk:</strong> 15% of users (3.8M) lack support
                        </div>
                        <h3 style="margin-top: 20px;">Current Support:</h3>
                        <p>85% global support | Safe for most markets except older Firefox versions</p>
                    `
                },
                'scroll-snap': {
                    title: 'scroll-snap Analysis',
                    content: `
                        <h2>scroll-snap - Gallery View</h2>
                        <div style="background: #d4edda; border-left: 4px solid #28a745; padding: 15px; border-radius: 10px;">
                            <strong>‚úÖ Low Risk:</strong> 95% global support - This is Baseline!
                        </div>
                        <h3 style="margin-top: 20px;">Status:</h3>
                        <p>Baseline Widely Available - Safe to use in production</p>
                    `
                }
            };

            const feature = features[featureType];
            modalBody.innerHTML = `${feature.content}`;
            modal.classList.add('show');
        }

        function closeModal() {
            document.getElementById('detailModal').classList.remove('show');
        }

        // Compatibility analysis with realistic data
        function analyzeCompatibility() {
            const btn = document.getElementById('analyzeBtn');
            const btnText = document.getElementById('analyzeBtnText');
            const select = document.getElementById('uiSelect');
            const selectedValue = select.value;
            
            btn.disabled = true;
            btnText.innerHTML = '<span class="loading"></span> Analyzing...';

            setTimeout(() => {
                const data = {
                    'dashboard': {
                        name: 'Dashboard v2.3',
                        globalSupport: 76.8,
                        baseline: 64,
                        features: 8,
                        risk: 6.2,
                        regions: [
                            { name: 'üá∫üá∏ North America', support: 91.2, browsers: 'Chrome 110+: 78%, Safari 16+: 15%', impact: 'low', color: '#2ed573' },
                            { name: 'üá™üá∫ Europe', support: 88.5, browsers: 'Chrome 110+: 72%, Firefox 115+: 18%', impact: 'low', color: '#26de81' },
                            { name: 'üáÆüá≥ India', support: 62.3, browsers: 'Chrome 95-110: 45%, Samsung Internet: 23%', impact: 'high', color: '#ff4757' },
                            { name: 'üáßüá∑ Latin America', support: 69.7, browsers: 'Chrome 100-110: 52%, Opera: 18%', impact: 'medium', color: '#ffa502' },
                            { name: 'üá®üá≥ Asia Pacific', support: 71.4, browsers: 'Chrome 105+: 58%, Safari: 12%', impact: 'medium', color: '#ffa502' }
                        ],
                        markets: [
                            { name: 'India - Older Android devices (Samsung Internet, UC Browser)', users: '2.8M', risk: 'high' },
                            { name: 'Brazil - Chrome 95-100 on low-end devices', users: '1.2M', risk: 'medium' },
                            { name: 'Indonesia - Opera Mini users', users: '890K', risk: 'medium' }
                        ]
                    },
                    'product': {
                        name: 'Product Listing Page',
                        globalSupport: 94.2,
                        baseline: 88,
                        features: 5,
                        risk: 2.1,
                        regions: [
                            { name: 'üá∫üá∏ North America', support: 97.8, browsers: 'Chrome 90+: 82%, Safari 14+: 16%', impact: 'low', color: '#2ed573' },
                            { name: 'üá™üá∫ Europe', support: 96.1, browsers: 'Chrome 90+: 78%, Firefox 88+: 18%', impact: 'low', color: '#2ed573' },
                            { name: 'üáÆüá≥ India', support: 89.2, browsers: 'Chrome 90+: 78%, others: 11%', impact: 'low', color: '#26de81' },
                            { name: 'üáßüá∑ Latin America', support: 91.8, browsers: 'Chrome 90+: 82%, Opera: 10%', impact: 'low', color: '#26de81' },
                            { name: 'üá®üá≥ Asia Pacific', support: 93.5, browsers: 'Chrome 90+: 85%, Safari: 8%', impact: 'low', color: '#2ed573' }
                        ],
                        markets: [
                            { name: 'India - Legacy IE11 enterprise users', users: '420K', risk: 'low' },
                            { name: 'Global - Very old Chrome versions (<80)', users: '180K', risk: 'low' }
                        ]
                    },
                    'profile': {
                        name: 'User Profile',
                        globalSupport: 82.5,
                        baseline: 71,
                        features: 6,
                        risk: 4.8,
                        regions: [
                            { name: 'üá∫üá∏ North America', support: 93.4, browsers: 'Chrome 105+: 80%, Safari 15+: 14%', impact: 'low', color: '#2ed573' },
                            { name: 'üá™üá∫ Europe', support: 90.2, browsers: 'Chrome 105+: 74%, Firefox 100+: 16%', impact: 'low', color: '#26de81' },
                            { name: 'üáÆüá≥ India', support: 68.7, browsers: 'Chrome 95-105: 48%, Samsung Internet: 21%', impact: 'medium', color: '#ffa502' },
                            { name: 'üáßüá∑ Latin America', support: 74.3, browsers: 'Chrome 100-105: 56%, Opera: 18%', impact: 'medium', color: '#ffa502' },
                            { name: 'üá®üá≥ Asia Pacific', support: 78.9, browsers: 'Chrome 100+: 65%, Safari: 13%', impact: 'low', color: '#26de81' }
                        ],
                        markets: [
                            { name: 'India - backdrop-filter unsupported devices', users: '1.8M', risk: 'high' },
                            { name: 'Brazil - scroll-snap issues on Chrome 95-100', users: '720K', risk: 'medium' }
                        ]
                    },
                    'admin': {
                        name: 'Admin Panel',
                        globalSupport: 58.3,
                        baseline: 42,
                        features: 12,
                        risk: 8.7,
                        regions: [
                            { name: 'üá∫üá∏ North America', support: 72.5, browsers: 'Chrome 105+: 62%, Safari 15+: 10%', impact: 'medium', color: '#ffa502' },
                            { name: 'üá™üá∫ Europe', support: 68.9, browsers: 'Chrome 105+: 58%, Firefox 100+: 11%', impact: 'medium', color: '#ffa502' },
                            { name: 'üáÆüá≥ India', support: 41.2, browsers: 'Chrome 85-105: 30%, older browsers: 11%', impact: 'high', color: '#ff4757' },
                            { name: 'üáßüá∑ Latin America', support: 48.7, browsers: 'Chrome 90-105: 38%, Opera: 11%', impact: 'high', color: '#ff4757' },
                            { name: 'üá®üá≥ Asia Pacific', support: 52.1, browsers: 'Chrome 90-105: 42%, various: 10%', impact: 'high', color: '#ff6348' }
                        ],
                        markets: [
                            { name: 'India - Legacy MutationObserver issues', users: '4.2M', risk: 'high' },
                            { name: 'Global - Multiple deprecated API usage', users: '2.1M', risk: 'high' },
                            { name: 'Brazil - document.write() blocking', users: '1.3M', risk: 'high' }
                        ]
                    }
                };

                const uiData = data[selectedValue];
                
                document.getElementById('selectedUI').textContent = uiData.name;
                document.getElementById('globalSupport').textContent = uiData.globalSupport + '%';
                document.getElementById('baselineCompliant').textContent = uiData.baseline + '%';
                document.getElementById('featuresDetected').textContent = uiData.features;
                document.getElementById('riskScore').textContent = uiData.risk + '/10';

                // Update region table
                const tbody = document.getElementById('regionTableBody');
                tbody.innerHTML = '';
                uiData.regions.forEach(region => {
                    const badgeClass = region.impact === 'high' ? 'high-risk' : region.impact === 'medium' ? 'medium-risk' : 'low-risk';
                    tbody.innerHTML += `
                        <tr>
                            <td>${region.name}</td>
                            <td><strong>${region.support}%</strong></td>
                            <td style="font-size: 0.85em; color: #666;">${region.browsers}</td>
                            <td><span class="badge ${badgeClass}">${region.impact.charAt(0).toUpperCase() + region.impact.slice(1)}</span></td>
                        </tr>
                    `;
                });

                // Update affected markets
                const marketsList = document.getElementById('affectedMarketsList');
                marketsList.innerHTML = '';
                uiData.markets.forEach(market => {
                    const badgeClass = market.risk === 'high' ? 'high-risk' : market.risk === 'medium' ? 'medium-risk' : 'low-risk';
                    marketsList.innerHTML += `
                        <li class="feature-item">
                            <span>${market.name}</span>
                            <span class="badge ${badgeClass}">${market.users} users</span>
                        </li>
                    `;
                });

                // Create compatibility chart
                const ctx = document.getElementById('compatChart').getContext('2d');
                if (compatChart) compatChart.destroy();
                compatChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: uiData.regions.map(r => r.name),
                        datasets: [{
                            label: 'Support %',
                            data: uiData.regions.map(r => r.support),
                            backgroundColor: uiData.regions.map(r => r.color),
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        }
                    }
                });

                document.getElementById('compatResult').style.display = 'block';
                btn.disabled = false;
                btnText.textContent = 'Analyze Compatibility';
                
                // Scroll to results
                document.getElementById('compatResult').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 1500);
        }

        // Risk assessment with dynamic data
        function assessRisk() {
            const featureName = document.getElementById('featureName').value || 'CSS :has() selector';
            const market = document.getElementById('targetMarket').value;
            
            const btn = event.target;
            const btnText = document.getElementById('assessBtnText');
            btn.disabled = true;
            btnText.innerHTML = '<span class="loading"></span> Calculating risk...';

            setTimeout(() => {
                const features = {
                    'CSS :has() selector': {
                        support: 68,
                        users: 8.2,
                        year: 2026,
                        risk: 7.5,
                        level: 'High Risk',
                        description: 'CSS :has() selector will impact 32% of your global user base',
                        alternatives: [
                            { name: 'Use JavaScript classList + querySelectorAll', detail: '100% support, requires more code but universally compatible', badge: 'low-risk', text: 'Recommended' },
                            { name: 'Polyfill with :has-polyfill library', detail: 'Adds 8KB, slight performance penalty', badge: 'medium-risk', text: 'Alternative' },
                            { name: 'Progressive enhancement strategy', detail: 'Provide fallback styles for unsupported browsers', badge: 'low-risk', text: 'Best Practice' }
                        ],
                        timeline: [
                            { date: 'Today (2025)', desc: '68% global support - High risk for production use' },
                            { date: 'Q2 2026', desc: 'Expected to reach 80% support - Medium risk' },
                            { date: 'Q4 2026', desc: 'Expected to reach 90% support - Low risk, safe for adoption' },
                            { date: '2027', desc: 'Becomes Baseline - Recommended for all UIs' }
                        ],
                        recommendation: 'Delay adoption until Q4 2026 or implement with progressive enhancement. Consider the JavaScript alternative for critical UIs serving India and Latin America markets.'
                    },
                    'Container Queries': {
                        support: 72,
                        users: 7.1,
                        year: 2026,
                        risk: 6.8,
                        level: 'High Risk',
                        description: 'Container Queries will impact 28% of your global user base',
                        alternatives: [
                            { name: 'Use ResizeObserver with JavaScript', detail: '98% support, more flexible but requires JS', badge: 'low-risk', text: 'Recommended' },
                            { name: 'CSS Grid with media queries', detail: '100% support for modern layouts', badge: 'low-risk', text: 'Baseline' },
                            { name: 'Container query polyfill', detail: 'Adds 12KB, covers older browsers', badge: 'medium-risk', text: 'Polyfill' }
                        ],
                        timeline: [
                            { date: 'Today (2025)', desc: '72% global support - Moderate risk' },
                            { date: 'Q3 2026', desc: 'Expected to reach 85% support - Low-medium risk' },
                            { date: 'Q1 2027', desc: 'Expected to reach 92% support - Safe for production' },
                            { date: '2027', desc: 'Becomes Baseline Widely Available' }
                        ],
                        recommendation: 'Can be adopted with ResizeObserver fallback. Good candidate for progressive enhancement in Q2 2026.'
                    },
                    'View Transitions API': {
                        support: 55,
                        users: 11.5,
                        year: 2027,
                        risk: 9.2,
                        level: 'Very High Risk',
                        description: 'View Transitions API will impact 45% of your global user base',
                        alternatives: [
                            { name: 'CSS transitions and animations', detail: '100% support, Baseline approved', badge: 'low-risk', text: 'Recommended' },
                            { name: 'GSAP or Framer Motion libraries', detail: 'Full cross-browser support, 40-80KB bundle', badge: 'medium-risk', text: 'Alternative' },
                            { name: 'Feature detection with @supports', detail: 'Graceful degradation strategy', badge: 'low-risk', text: 'Progressive' }
                        ],
                        timeline: [
                            { date: 'Today (2025)', desc: '55% global support - Very high risk' },
                            { date: 'Q2 2026', desc: 'Expected to reach 68% support - Still high risk' },
                            { date: 'Q2 2027', desc: 'Expected to reach 82% support - Medium risk' },
                            { date: '2028', desc: 'Expected Baseline status' }
                        ],
                        recommendation: 'Do NOT use in production without comprehensive fallbacks. Wait until 2027 or use CSS animations for critical transitions.'
                    },
                    'backdrop-filter': {
                        support: 82,
                        users: 4.6,
                        year: 2025,
                        risk: 4.2,
                        level: 'Medium Risk',
                        description: 'backdrop-filter will impact 18% of your global user base',
                        alternatives: [
                            { name: 'Semi-transparent background colors', detail: '100% support, simpler approach', badge: 'low-risk', text: 'Recommended' },
                            { name: 'SVG filters as fallback', detail: '95% support, more complex implementation', badge: 'low-risk', text: 'Alternative' },
                            { name: 'Feature detection with @supports', detail: 'Apply only where supported', badge: 'low-risk', text: 'Progressive' }
                        ],
                        timeline: [
                            { date: 'Today (2025)', desc: '82% global support - Medium risk, acceptable for non-critical UIs' },
                            { date: 'Q2 2025', desc: 'Expected to reach 88% support - Low risk' },
                            { date: 'Q4 2025', desc: 'Expected to reach 92% support - Safe for production' },
                            { date: '2026', desc: 'Expected Baseline status' }
                        ],
                        recommendation: 'Can be adopted with @supports feature detection. Provide solid color fallback for older Firefox versions.'
                    }
                };

                let featureData = features[featureName] || features['CSS :has() selector'];

                // Update risk gauge
                const gauge = document.getElementById('riskGauge');
                gauge.textContent = featureData.risk + '/10';
                if (featureData.risk >= 7) {
                    gauge.style.background = 'linear-gradient(135deg, #ff6348 0%, #ff4757 100%)';
                } else if (featureData.risk >= 4) {
                    gauge.style.background = 'linear-gradient(135deg, #ffa502 0%, #ff6348 100%)';
                } else {
                    gauge.style.background = 'linear-gradient(135deg, #2ed573 0%, #26de81 100%)';
                }

                document.getElementById('riskLevel').textContent = featureData.level + ' Feature';
                document.getElementById('riskDescription').textContent = featureData.description;
                document.getElementById('supportPercentage').textContent = featureData.support + '%';
                document.getElementById('usersImpacted').textContent = featureData.users + 'M';
                document.getElementById('safeYear').textContent = featureData.year;

                // Update timeline
                const timeline = document.getElementById('impactTimeline');
                timeline.innerHTML = '';
                featureData.timeline.forEach(item => {
                    timeline.innerHTML += `
                        <div class="timeline-item">
                            <strong>${item.date}</strong>
                            <div style="margin-top: 5px;">${item.desc}</div>
                        </div>
                    `;
                });

                // Update alternatives
                const altList = document.getElementById('alternativesList');
                altList.innerHTML = '';
                featureData.alternatives.forEach(alt => {
                    altList.innerHTML += `
                        <li class="feature-item">
                            <div>
                                <div class="feature-name">${alt.name}</div>
                                <div style="font-size: 0.9em; color: #666;">${alt.detail}</div>
                            </div>
                            <span class="badge ${alt.badge}">${alt.text}</span>
                        </li>
                    `;
                });

                document.getElementById('finalRecommendation').textContent = featureData.recommendation;

                // Create risk trend chart
                const ctx = document.getElementById('riskTrendChart').getContext('2d');
                if (riskTrendChart) riskTrendChart.destroy();
                riskTrendChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Today', 'Q2 2025', 'Q4 2025', 'Q2 2026', 'Q4 2026', '2027'],
                        datasets: [{
                            label: 'Projected Support %',
                            data: [featureData.support, featureData.support + 5, featureData.support + 12, featureData.support + 17, featureData.support + 22, featureData.support + 27],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            tension: 0.4,
                            fill: true
                        }, {
                            label: 'Safe Threshold (90%)',
                            data: [90, 90, 90, 90, 90, 90],
                            borderColor: '#2ed573',
                            borderDash: [5, 5],
                            fill: false
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            }
                        }
                    }
                });

                document.getElementById('riskReport').classList.add('show');
                btn.disabled = false;
                btnText.textContent = 'Assess Risk';
                
                document.getElementById('riskReport').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }, 1800);
        }

        // Show team detail
        function showTeamDetail(teamId, score) {
            document.getElementById('teamName').textContent = 'Team ' + teamId.charAt(0).toUpperCase() + teamId.slice(1);
            document.getElementById('teamScore').textContent = score;

            // Update team chart
            const ctx = document.getElementById('teamChart').getContext('2d');
            if (teamChart) teamChart.destroy();
            
            const baselinePercent = score;
            const legacyPercent = Math.floor((100 - score) * 0.5);
            const deprecatedPercent = Math.floor((100 - score) * 0.27);
            const modernPercent = 100 - baselinePercent - legacyPercent - deprecatedPercent;

            teamChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Baseline Features', 'Legacy Features', 'Deprecated Code', 'Modern (Non-Baseline)'],
                    datasets: [{
                        data: [baselinePercent, legacyPercent, deprecatedPercent, modernPercent],
                        backgroundColor: ['#2ed573', '#ffa502', '#ff4757', '#667eea']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Scroll to team breakdown
            document.querySelector('#heatmap .card:last-child').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Show remediation
        function showRemediation(type) {
            const remediations = {
                'mutation': {
                    text: 'We detected 25 UIs using deprecated MutationObserver patterns. We can automatically generate a pull request to update these to modern observers with proper configuration options.',
                    code: `// Old pattern
new MutationObserver(callback).observe(target, { attributes: true, childList: true });

// Recommended pattern
const observer = new MutationObserver((mutations) => {
  mutations.forEach((mutation) => {
    if (mutation.type === 'childList') {
      // Handle child list changes
    }
  });
});
observer.observe(target, { 
  childList: true, 
  subtree: true,
  attributeFilter: ['class', 'data-state']
});`
                },
                'prefix': {
                    text: 'Found 18 UIs with -webkit- vendor prefixes only. We can add cross-browser prefixes using autoprefixer and remove unnecessary ones.',
                    code: `/* Before */
.element {
  -webkit-transform: rotate(45deg);
}

/* After (autoprefixer) */
.element {
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  transform: rotate(45deg);
}`
                },
                'docwrite': {
                    text: '12 UIs use document.write() which blocks page rendering. We can convert these to async script loading or innerHTML updates.',
                    code: `// Old (blocking)
document.write('<script src="analytics.js"></script>');

// New (non-blocking)
const script = document.createElement('script');
script.src = 'analytics.js';
script.async = true;
document.head.appendChild(script);`
                },
                'flash': {
                    text: '5 UIs have dead Flash fallback code. We can safely remove these code paths as Flash support ended in 2020.',
                    code: `// Can be safely removed
if (hasFlash()) {
  loadFlashPlayer();
} else {
  loadHTML5Player(); // Keep only this
}`
                },
                'has': {
                    text: 'CSS :has() selector detected. We can provide a JavaScript-based fallback for older browsers.',
                    code: `// Fallback implementation
if (!CSS.supports('selector(:has(*))')) {
  document.querySelectorAll('.card').forEach(card => {
    if (card.querySelector('.active-badge')) {
      card.classList.add('has-active-badge');
    }
  });
}

/* CSS */
.card:has(.active-badge),
.card.has-active-badge {
  border: 2px solid #667eea;
}`
                }
            };

            const rem = remediations[type];
            document.getElementById('remediationText').innerHTML = `
                <p>${rem.text}</p>
                <div class="code-snippet">${rem.code}</div>
            `;
            document.getElementById('remediationBox').style.display = 'block';
            document.getElementById('remediationBox').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Generate PR
        function generatePR() {
            alert('üöÄ Pull Request Generation\n\nIn production, this would:\n\n1. Create a new branch: feature/automated-remediation-123\n2. Apply code fixes using AST transformations\n3. Run tests to ensure no breaking changes\n4. Create PR with detailed changelog\n5. Tag relevant team members for review\n\nEstimated changes: 87 files across 12 repositories');
        }

        // Export A/B config
        function exportABConfig() {
            const config = {
                experiment_name: "css_has_selector_rollout",
                cohorts: [
                    {
                        name: "control",
                        percentage: 60,
                        browsers: ["Chrome < 110", "Safari < 16.4", "Firefox < 121"],
                        implementation: "javascript_fallback"
                    },
                    {
                        name: "treatment",
                        percentage: 40,
                        browsers: ["Chrome >= 110", "Safari >= 16.4", "Firefox >= 121"],
                        implementation: "native_has_selector"
                    }
                ],
                metrics: ["error_rate", "page_load_time", "user_engagement"],
                duration_days: 14
            };
            
            const blob = new Blob([JSON.stringify(config, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'ab-test-config.json';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Initialize charts on load
        window.onload = function() {
            // Trend Chart
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep'],
                    datasets: [{
                        label: 'Baseline Compliance %',
                        data: [72, 74, 76, 78, 80, 83, 85, 86, 87.3],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'High-Risk Features',
                        data: [28, 26, 24, 22, 20, 17, 15, 14, 12],
                        borderColor: '#ff4757',
                        backgroundColor: 'rgba(255, 71, 87, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });

            // Team Chart (default Echo)
            const teamCtx = document.getElementById('teamChart').getContext('2d');
            teamChart = new Chart(teamCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Baseline Features', 'Legacy Features', 'Deprecated Code', 'Modern (Non-Baseline)'],
                    datasets: [{
                        data: [43, 28, 15, 14],
                        backgroundColor: ['#2ed573', '#ffa502', '#ff4757', '#667eea']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // ML Accuracy Chart
            const mlCtx = document.getElementById('mlAccuracyChart').getContext('2d');
            mlAccuracyChart = new Chart(mlCtx, {
                type: 'line',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6', 'Week 7', 'Week 8'],
                    datasets: [{
                        label: 'Model Accuracy',
                        data: [78.2, 81.5, 83.7, 85.1, 86.4, 86.9, 87.1, 87.3],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Precision',
                        data: [82.1, 83.8, 85.2, 86.5, 87.2, 88.1, 88.5, 89.2],
                        borderColor: '#2ed573',
                        backgroundColor: 'rgba(46, 213, 115, 0.1)',
                        tension: 0.4,
                        fill: true
                    }, {
                        label: 'Recall',
                        data: [75.3, 79.2, 81.8, 83.7, 85.1, 85.8, 86.2, 86.7],
                        borderColor: '#ffa502',
                        backgroundColor: 'rgba(255, 165, 2, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        }
                    }
                }
            });
        };
    </script>
</body>
</html> class="label">Real User Error Rate</div>
                        <div class="value">3.2%</div>
                    </div>
                    <div class="rum-stat">
                        <div class="label">Avg Load Time</div>
                        <div class="value">2.8s</div>
                    </div>
                    <div class="rum-stat">
                        <div class="label">JS Errors (7 days)</div>
                        <div class="value">847</div>
                    </div>
                    <div class="rum-stat">
                        <div
